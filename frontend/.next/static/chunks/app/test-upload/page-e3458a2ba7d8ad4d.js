(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[534],{8571:function(e){var t,s,o,n=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(e){s=i}}();var c=[],l=!1,u=-1;function d(){l&&o&&(l=!1,o.length?c=o.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=a(d);l=!0;for(var t=c.length;t;){for(o=c,c=[];++u<t;)o&&o[u].run();u=-1,t=c.length}o=null,l=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];c.push(new f(e,t)),1!==c.length||l||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}},7411:function(e,t,s){Promise.resolve().then(s.bind(s,498))},498:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return a}});var o=s(7821),n=s(8078),r=s(1794),i=s(7469);function a(){let[e,t]=(0,n.useState)(""),[s,a]=(0,n.useState)([]),c=e=>{a(t=>[...t,"".concat(new Date().toISOString(),": ").concat(e)]),console.log(e)},l=async()=>{try{c("Testing authentication...");let e=await r.x.auth.verify();c("Auth successful: ".concat(JSON.stringify(e))),t("✅ Authentication working")}catch(e){c("Auth failed: ".concat(e)),t("❌ Authentication failed")}},u=async()=>{try{c("Testing upload service...");let e=await fetch("https://pharmx-api.kasimhussain333.workers.dev/api/v1/upload/test"),s=await e.json();c("Upload service test: ".concat(JSON.stringify(s))),t(s.hasR2&&s.hasDB?"✅ Upload service configured":"❌ Upload service misconfigured")}catch(e){c("Upload service test failed: ".concat(e)),t("❌ Upload service test failed")}},d=async e=>{var s;let o=null===(s=e.target.files)||void 0===s?void 0:s[0];if(o){c("Selected file: ".concat(o.name,", size: ").concat(o.size,", type: ").concat(o.type));try{c("Uploading file...");let e=await r.x.profile.uploadAvatar(o);c("Upload successful: ".concat(JSON.stringify(e))),t("✅ File uploaded successfully!")}catch(e){c("Upload failed: ".concat(e)),t("❌ Upload failed: ".concat(e))}}};return(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Upload Test Page"}),(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)(i.z,{onClick:l,children:"Test Authentication"}),(0,o.jsx)(i.z,{onClick:u,className:"ml-2",children:"Test Upload Service"})]}),(0,o.jsx)("div",{className:"border-t pt-4",children:(0,o.jsxs)("label",{className:"block",children:[(0,o.jsx)("span",{className:"text-sm font-medium",children:"Test File Upload:"}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:d,className:"mt-1 block w-full text-sm text-gray-500   file:mr-4 file:py-2 file:px-4   file:rounded-full file:border-0   file:text-sm file:font-semibold   file:bg-violet-50 file:text-violet-700   hover:file:bg-violet-100"})]})}),e&&(0,o.jsx)("div",{className:"p-3 rounded ".concat(e.startsWith("✅")?"bg-green-100":"bg-red-100"),children:e}),(0,o.jsxs)("div",{className:"border-t pt-4",children:[(0,o.jsx)("h3",{className:"font-semibold mb-2",children:"Logs:"}),(0,o.jsx)("div",{className:"bg-gray-100 rounded p-3 h-64 overflow-y-auto",children:0===s.length?(0,o.jsx)("p",{className:"text-gray-500",children:"No logs yet..."}):s.map((e,t)=>(0,o.jsx)("div",{className:"text-xs font-mono mb-1",children:e},t))})]}),(0,o.jsxs)("div",{className:"border-t pt-4 text-sm text-gray-600",children:[(0,o.jsx)("p",{children:"Also check your browser console (F12) for detailed logs."}),(0,o.jsx)("p",{children:"API URL: https://pharmx-api.kasimhussain333.workers.dev"})]})]})]})})}},7469:function(e,t,s){"use strict";s.d(t,{z:function(){return l}});var o=s(7821),n=s(8078),r=s(7035),i=s(898),a=s(3892);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:l=!1,...u}=e,d=l?r.g7:"button";return(0,o.jsx)(d,{className:(0,a.cn)(c({variant:n,size:i,className:s})),ref:t,...u})});l.displayName="Button"},1794:function(e,t,s){"use strict";s.d(t,{x:function(){return r}});let o=s(8571).env.NEXT_PUBLIC_API_URL||"https://pharmx-api.kasimhussain333.workers.dev";class n{setAuth(e,t){console.log("[API Client] Setting auth - Token length:",e.length,"Session ID:",t),this.token=e,this.sessionId=t,localStorage.setItem("pharmx_token",e),localStorage.setItem("pharmx_session",t),console.log("[API Client] Stored auth in localStorage")}setToken(e){console.log("[API Client] Setting token only - Length:",e.length),this.token=e,localStorage.setItem("pharmx_token",e),console.log("[API Client] Stored token in localStorage")}getToken(){return this.token||(this.token=localStorage.getItem("pharmx_token")),this.token}getSessionId(){return this.sessionId||(this.sessionId=localStorage.getItem("pharmx_session")),this.sessionId}clearAuth(){this.token=null,this.sessionId=null,localStorage.removeItem("pharmx_token"),localStorage.removeItem("pharmx_session")}clearToken(){this.clearAuth()}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={...t.headers||{}};s["Content-Type"]||t.body instanceof FormData||(s["Content-Type"]="application/json"),this.token&&(s.Authorization="Bearer ".concat(this.token)),this.sessionId&&(s["X-Session-ID"]=this.sessionId);let n="".concat(o).concat(e);console.log("[API] ".concat(t.method||"GET"," ").concat(n)),console.log("[API] Headers:",s),t.body instanceof FormData&&console.log("[API] Sending FormData with keys:",Array.from(t.body.keys()));try{let o=await fetch(n,{...t,headers:s,credentials:"include",mode:"cors"});if(!o.ok){let t="Request failed with status ".concat(o.status),s=null;try{let n=await o.json();t=n.error||n.message||t,s=n.details,console.error("[API Error] ".concat(e,":"),n)}catch(e){t=o.statusText||t}401===o.status&&(console.log("[API] 401 Unauthorized - clearing auth and redirecting to login"),this.clearAuth(),window.location.href="/login");let n=Error(t);throw s&&(n.details=s),n}let r=await o.json();return console.log("[API Response] ".concat(e,":"),r),r}catch(e){if(e instanceof TypeError&&"Failed to fetch"===e.message)throw console.error("[API] Network error - Failed to fetch. Possible causes:"),console.error("  1. CORS blocking the request"),console.error("  2. Network connectivity issues"),console.error("  3. API server is down"),console.error("  4. SSL/TLS certificate issues"),console.error("  URL: ".concat(n)),Error("Network error: Unable to connect to the server. Please check your connection and try again.");throw e}}constructor(){this.token=null,this.sessionId=null,this.auth={logout:async()=>{await this.request("/auth/logout",{method:"POST"}),this.clearAuth()},verify:()=>this.request("/auth/verify")},this.profile={get:()=>this.request("/profile"),update:e=>this.request("/profile",{method:"PUT",body:JSON.stringify(e)}),uploadAvatar:async e=>{let t=new FormData;return t.append("file",e),this.request("/upload/avatar",{method:"POST",body:t})},create:e=>this.request("/profile",{method:"POST",body:JSON.stringify(e)}),delete:()=>this.request("/profile",{method:"DELETE"})},this.users={list:e=>{let t=new URLSearchParams(e).toString();return this.request("/users".concat(t?"?".concat(t):""))},get:e=>this.request("/users/".concat(e)),search:e=>this.request("/users/search?q=".concat(encodeURIComponent(e)))},this.chats={list:()=>this.request("/chats"),create:e=>this.request("/chats",{method:"POST",body:JSON.stringify({otherUserId:e})}),getMessages:(e,t)=>{let s=new URLSearchParams(t).toString();return this.request("/chats/".concat(e,"/messages").concat(s?"?".concat(s):""))},sendMessage:(e,t)=>this.request("/chats/".concat(e,"/messages"),{method:"POST",body:JSON.stringify({content:t})})},this.health=()=>fetch("".concat(o,"/health")).then(e=>e.json()),this.token=localStorage.getItem("pharmx_token"),this.sessionId=localStorage.getItem("pharmx_session")}}let r=new n},3892:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var o=s(2605),n=s(1638);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,o.W)(t))}},898:function(e,t,s){"use strict";s.d(t,{j:function(){return i}});var o=s(2605);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,r=o.W,i=(e,t)=>s=>{var o;if((null==t?void 0:t.variants)==null)return r(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:i,defaultVariants:a}=t,c=Object.keys(i).map(e=>{let t=null==s?void 0:s[e],o=null==a?void 0:a[e];if(null===t)return null;let r=n(t)||n(o);return i[e][r]}),l=s&&Object.entries(s).reduce((e,t)=>{let[s,o]=t;return void 0===o||(e[s]=o),e},{});return r(e,c,null==t?void 0:null===(o=t.compoundVariants)||void 0===o?void 0:o.reduce((e,t)=>{let{class:s,className:o,...n}=t;return Object.entries(n).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...a,...l}[t]):({...a,...l})[t]===s})?[...e,s,o]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}},function(e){e.O(0,[966,115,364,744],function(){return e(e.s=7411)}),_N_E=e.O()}]);