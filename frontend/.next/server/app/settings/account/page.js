(()=>{var e={};e.id=496,e.ids=[496],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},2042:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),r(1312),r(5943),r(2874);var s=r(7105),a=r(5265),o=r(157),i=r.n(o),n=r(4665),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let d=["",{children:["settings",{children:["account",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1312)),"C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\settings\\account\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7418))).default(e),async e=>(await Promise.resolve().then(r.bind(r,9527))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,9204))).default(e)],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,5943)),"C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,2874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7418))).default(e),async e=>(await Promise.resolve().then(r.bind(r,9527))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,9204))).default(e)],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\settings\\account\\page.tsx"],u="/settings/account/page",m={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/settings/account/page",pathname:"/settings/account",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2052:(e,t,r)=>{Promise.resolve().then(r.bind(r,2744))},2744:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var s=r(9899),a=r(6153),o=r(5507),i=r(5950),n=r(5650),l=r(7513),d=r(7241),c=r(6711),u=r(8455),m=r(573),h=r(3184),p=r(3707),g=r(2681),f=r(1614),x=r(6539),b=r(4175),y=r(3134);let v=e=>{if(!e)return"";if(e.startsWith("http"))return e;let t=process.env.NEXT_PUBLIC_API_URL||"";return`${t}${e}`},w=l.Ry({name:l.Z_().min(2).max(40),gender:l.Km(["male","female"]),dobDay:l.Z_().regex(/^(0?[1-9]|[12][0-9]|3[01])$/,"Invalid day"),dobMonth:l.Z_().regex(/^(0?[1-9]|1[012])$/,"Invalid month"),dobYear:l.Z_().regex(/^(19|20)\d{2}$/,"Invalid year").refine(e=>new Date().getFullYear()-parseInt(e)>=18,"You must be at least 18 years old"),bio:l.Z_().max(160),avatarUrl:l.Z_().optional()});function N(){let e=(0,a.useRouter)(),{toast:t}=(0,p.pm)(),[r,l]=(0,o.useState)(""),[N,j]=(0,o.useState)(!1),[P,k]=(0,o.useState)(""),[_,S]=(0,o.useState)(""),[I,q]=(0,o.useState)(""),{register:A,handleSubmit:U,formState:{errors:$,isSubmitting:D},setValue:C,watch:T}=(0,i.cI)({resolver:(0,n.F)(w)}),E=T(),F=async()=>{try{let e=await y.x.profile.get(),t={name:e.name||e.username||"",email:e.email||"",gender:e.gender||"male",dob:e.dob||"",bio:e.bio||"",avatarUrl:e.avatar_url||e.profile_picture_url||null};if(l(v(t.avatarUrl)),C("name",t.name),C("gender",t.gender),C("bio",t.bio),C("avatarUrl",t.avatarUrl||""),t.dob){let e=new Date(t.dob),r=e.getDate().toString().padStart(2,"0"),s=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getFullYear().toString();k(r),S(s),q(a),C("dobDay",r),C("dobMonth",s),C("dobYear",a)}}catch(e){console.error("Error fetching profile:",e),t({title:"Error loading profile",description:"Failed to load your profile data",variant:"destructive"})}},M=async e=>{let r=e.target.files?.[0];if(!r)return;if(r.size>10485760){t({title:"File too large",description:"Please select an image under 10MB",variant:"destructive"});return}let s=new FileReader;s.onloadend=()=>{l(s.result)},s.readAsDataURL(r),j(!0);try{let e=await y.x.profile.uploadAvatar(r);C("avatarUrl",e.url),l(v(e.url)),t({title:"Photo updated",description:"Your profile photo has been updated"})}catch(e){console.error("Upload error:",e),t({title:"Upload failed",description:e instanceof Error?e.message:"Failed to upload image",variant:"destructive"})}finally{j(!1)}},R=async e=>{try{let r=`${e.dobYear}-${e.dobMonth.padStart(2,"0")}-${e.dobDay.padStart(2,"0")}`,s={name:e.name,gender:e.gender,dob:r,bio:e.bio,avatarUrl:e.avatarUrl};await y.x.profile.update(s),t({title:"Profile updated",description:"Your profile has been successfully updated"}),await F()}catch(e){console.error("Profile update error:",e),t({title:"Update failed",description:e instanceof Error?e.message:"Failed to update profile",variant:"destructive"})}},Y=async()=>{if(window.confirm("Are you sure you want to delete your account? This action cannot be undone."))try{await y.x.profile.delete(),y.x.clearAuth(),t({title:"Account deleted",description:"Your account has been removed"}),e.push("/login")}catch(e){console.error("Delete account error:",e),t({title:"Deletion failed",description:e instanceof Error?e.message:"Failed to delete account",variant:"destructive"})}};return(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[s.jsx("div",{className:"sticky top-0 bg-background/95 backdrop-blur-sm border-b z-10",children:(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[s.jsx(b.default,{href:"/settings",className:"p-2 -ml-2",children:s.jsx(g.Z,{className:"h-5 w-5 rotate-180"})}),s.jsx("h1",{className:"text-lg font-semibold",children:"Account"}),s.jsx("div",{className:"w-9"})]})}),s.jsx("div",{className:"flex items-center justify-center p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsx("div",{className:"bg-white dark:bg-card rounded-2xl shadow-xl p-8",children:(0,s.jsxs)("form",{onSubmit:U(R),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[s.jsx("div",{className:"relative w-48 h-48 rounded-lg overflow-hidden border-4 border-gray-200",children:r?s.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${r})`}}):s.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:s.jsx(f.Z,{className:"w-16 h-16 text-gray-400"})})}),(0,s.jsxs)("div",{children:[s.jsx(c.I,{id:"avatar",type:"file",accept:"image/*",className:"hidden",onChange:M,disabled:N}),s.jsx(u._,{htmlFor:"avatar",className:"cursor-pointer inline-block",children:s.jsx("div",{className:"bg-white hover:bg-gray-100 text-black border border-gray-300 px-4 py-2 rounded-md text-sm font-medium transition-colors",children:N?"Uploading...":"Upload Photo"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"name",className:"text-gray-700 font-medium",children:"Name"}),s.jsx(c.I,{id:"name",placeholder:"Your display name",className:"w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500",...A("name")}),$.name&&s.jsx("p",{className:"text-sm text-red-500",children:$.name.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-gray-700 font-medium",children:"Gender"}),(0,s.jsxs)(m.E,{value:T("gender"),className:"flex gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(m.m,{value:"male",id:"male",disabled:!0,className:"text-black border-gray-400"}),s.jsx(u._,{htmlFor:"male",className:"text-gray-700",children:"Male"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(m.m,{value:"female",id:"female",disabled:!0,className:"text-black border-gray-400"}),s.jsx(u._,{htmlFor:"female",className:"text-gray-700",children:"Female"})]})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(x.Z,{className:"w-3 h-3"})," Cannot be changed"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{className:"text-gray-700 font-medium",children:"Date of Birth"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"DD",maxLength:2,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...A("dobDay"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");if(k(t),C("dobDay",t),2===t.length){let e=document.querySelector('input[name="dobMonth"]');e?.focus()}},value:P})}),s.jsx("div",{className:"flex-1",children:s.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"MM",maxLength:2,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...A("dobMonth"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");if(S(t),C("dobMonth",t),2===t.length){let e=document.querySelector('input[name="dobYear"]');e?.focus()}},value:_})}),s.jsx("div",{className:"flex-[1.5]",children:s.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"YYYY",maxLength:4,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...A("dobYear"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");q(t),C("dobYear",t)},value:I})})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"You must be 18 or older"}),($.dobDay||$.dobMonth||$.dobYear)&&s.jsx("p",{className:"text-sm text-red-500",children:$.dobDay?.message||$.dobMonth?.message||$.dobYear?.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(u._,{htmlFor:"bio",className:"text-gray-700 font-medium",children:"Bio"}),s.jsx(h.g,{id:"bio",placeholder:"Tell us about yourself...",className:"resize-none h-24 w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500",maxLength:160,...A("bio")}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 text-right",children:[E.bio?.length||0,"/160 characters"]}),$.bio&&s.jsx("p",{className:"text-sm text-red-500",children:$.bio.message})]}),s.jsx(d.z,{type:"submit",className:"w-full bg-black hover:bg-gray-900 text-white font-semibold py-3 rounded-lg transition-colors",disabled:D,children:D?"Updating...":"Update Profile"}),s.jsx(d.z,{type:"button",variant:"destructive",className:"w-full",onClick:Y,children:"Delete Account"})]})})})})]})}},7241:(e,t,r)=>{"use strict";r.d(t,{z:()=>d});var s=r(9899),a=r(5507),o=r(4036),i=r(1138),n=r(6409);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...i},d)=>{let c=a?o.g7:"button";return s.jsx(c,{className:(0,n.cn)(l({variant:t,size:r,className:e})),ref:d,...i})});d.displayName="Button"},6711:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var s=r(9899),a=r(5507),o=r(6409);let i=a.forwardRef(({className:e,type:t,...r},a)=>s.jsx("input",{type:t,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));i.displayName="Input"},8455:(e,t,r)=>{"use strict";r.d(t,{_:()=>d});var s=r(9899),a=r(5507),o=r(883),i=r(1138),n=r(6409);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...t},r)=>s.jsx(o.f,{ref:r,className:(0,n.cn)(l(),e),...t}));d.displayName=o.f.displayName},573:(e,t,r)=>{"use strict";r.d(t,{E:()=>l,m:()=>d});var s=r(9899),a=r(5507),o=r(2258),i=r(8443),n=r(6409);let l=a.forwardRef(({className:e,...t},r)=>s.jsx(o.fC,{className:(0,n.cn)("grid gap-2",e),...t,ref:r}));l.displayName=o.fC.displayName;let d=a.forwardRef(({className:e,...t},r)=>s.jsx(o.ck,{ref:r,className:(0,n.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(o.z$,{className:"flex items-center justify-center",children:s.jsx(i.Z,{className:"h-3.5 w-3.5 fill-primary"})})}));d.displayName=o.ck.displayName},3184:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});var s=r(9899),a=r(5507),o=r(6409);let i=a.forwardRef(({className:e,...t},r)=>s.jsx("textarea",{className:(0,o.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));i.displayName="Textarea"},3134:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});let s=process.env.NEXT_PUBLIC_API_URL||"https://pharmx-api.kasimhussain333.workers.dev";class a{constructor(){this.token=null,this.sessionId=null,this.auth={logout:async()=>{await this.request("/auth/logout",{method:"POST"}),this.clearAuth()},verify:()=>this.request("/auth/verify")},this.profile={get:()=>this.request("/profile"),update:e=>this.request("/profile",{method:"PUT",body:JSON.stringify(e)}),uploadAvatar:async e=>{let t=new FormData;return t.append("file",e),this.request("/upload/avatar",{method:"POST",body:t})},create:e=>this.request("/profile",{method:"POST",body:JSON.stringify(e)}),delete:()=>this.request("/profile",{method:"DELETE"})},this.users={list:e=>{let t=new URLSearchParams(e).toString();return this.request(`/users${t?`?${t}`:""}`)},get:e=>this.request(`/users/${e}`),search:e=>this.request(`/users/search?q=${encodeURIComponent(e)}`)},this.chats={list:()=>this.request("/chats"),create:e=>this.request("/chats",{method:"POST",body:JSON.stringify({otherUserId:e})}),getMessages:(e,t)=>{let r=new URLSearchParams(t).toString();return this.request(`/chats/${e}/messages${r?`?${r}`:""}`)},sendMessage:(e,t)=>this.request(`/chats/${e}/messages`,{method:"POST",body:JSON.stringify({content:t})})},this.health=()=>fetch(`${s}/health`).then(e=>e.json())}setAuth(e,t){console.log("[API Client] Setting auth - Token length:",e.length,"Session ID:",t),this.token=e,this.sessionId=t}setToken(e){console.log("[API Client] Setting token only - Length:",e.length),this.token=e}getToken(){return this.token,this.token}getSessionId(){return this.sessionId,this.sessionId}clearAuth(){this.token=null,this.sessionId=null}clearToken(){this.clearAuth()}async request(e,t={}){let r={...t.headers||{}};r["Content-Type"]||t.body instanceof FormData||(r["Content-Type"]="application/json"),this.token&&(r.Authorization=`Bearer ${this.token}`),this.sessionId&&(r["X-Session-ID"]=this.sessionId);let a=`${s}${e}`;console.log(`[API] ${t.method||"GET"} ${a}`),console.log("[API] Headers:",r),t.body instanceof FormData&&console.log("[API] Sending FormData with keys:",Array.from(t.body.keys()));try{let s=await fetch(a,{...t,headers:r,credentials:"include",mode:"cors"});if(!s.ok){let t=`Request failed with status ${s.status}`,r=null;try{let a=await s.json();t=a.error||a.message||t,r=a.details,console.error(`[API Error] ${e}:`,a)}catch{t=s.statusText||t}401===s.status&&(console.log("[API] 401 Unauthorized - clearing auth and redirecting to login"),this.clearAuth(),window.location.href="/login");let a=Error(t);throw r&&(a.details=r),a}let o=await s.json();return console.log(`[API Response] ${e}:`,o),o}catch(e){if(e instanceof TypeError&&"Failed to fetch"===e.message)throw console.error("[API] Network error - Failed to fetch. Possible causes:"),console.error("  1. CORS blocking the request"),console.error("  2. Network connectivity issues"),console.error("  3. API server is down"),console.error("  4. SSL/TLS certificate issues"),console.error(`  URL: ${a}`),Error("Network error: Unable to connect to the server. Please check your connection and try again.");throw e}}}let o=new a},2681:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(1278).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4175:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(696),a=r.n(s)},1312:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2772).createProxy)(String.raw`C:\Users\kasim\pharmx-social-1\frontend\app\settings\account\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[916,573,645,696,801,101],()=>r(2042));module.exports=s})();