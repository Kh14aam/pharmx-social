(()=>{var e={};e.id=461,e.ids=[461],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},9264:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),s(6904),s(5943),s(2874);var r=s(7105),a=s(5265),o=s(157),i=s.n(o),n=s(4665),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(t,l);let d=["",{children:["onboarding",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6904)),"C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\onboarding\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7418))).default(e),async e=>(await Promise.resolve().then(s.bind(s,9527))).default(e)],apple:[async e=>(await Promise.resolve().then(s.bind(s,9204))).default(e)],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,5943)),"C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2874,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7418))).default(e),async e=>(await Promise.resolve().then(s.bind(s,9527))).default(e)],apple:[async e=>(await Promise.resolve().then(s.bind(s,9204))).default(e)],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\kasim\\pharmx-social-1\\frontend\\app\\onboarding\\page.tsx"],u="/onboarding/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/onboarding/page",pathname:"/onboarding",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},107:(e,t,s)=>{Promise.resolve().then(s.bind(s,1104))},1104:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var r=s(9899),a=s(6153),o=s(5507),i=s(5950),n=s(5650),l=s(7513),d=s(7241),c=s(6711),u=s(8455),m=s(573),h=s(3184),g=s(3707),p=s(1614),x=s(6539),f=s(3134);let b=l.Ry({name:l.Z_().min(2).max(40),gender:l.Km(["male","female"]),dobDay:l.Z_().regex(/^(0?[1-9]|[12][0-9]|3[01])$/,"Invalid day"),dobMonth:l.Z_().regex(/^(0?[1-9]|1[012])$/,"Invalid month"),dobYear:l.Z_().regex(/^(19|20)\d{2}$/,"Invalid year").refine(e=>new Date().getFullYear()-parseInt(e)>=18,"You must be at least 18 years old"),bio:l.Z_().max(160),avatarUrl:l.Z_().optional()});function y(){let e=(0,a.useRouter)(),{toast:t}=(0,g.pm)(),[s,l]=(0,o.useState)(""),[y,v]=(0,o.useState)(!1),[w,N]=(0,o.useState)(""),[j,P]=(0,o.useState)(""),[k,S]=(0,o.useState)(""),[I,_]=(0,o.useState)(!0),{register:q,handleSubmit:$,formState:{errors:A,isSubmitting:C},setValue:U,watch:D}=(0,i.cI)({resolver:(0,n.F)(b)}),T=D();if(I)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-gray-600 rounded-full animate-spin mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Checking your profile..."})]})});let F=async e=>{let s=e.target.files?.[0];if(!s)return;if(console.log("[Onboarding] Selected file:",s.name,"size:",s.size,"type:",s.type),s.size>10485760){t({title:"File too large",description:"Please select an image under 10MB",variant:"destructive"});return}let r=new FileReader;r.onloadend=()=>{l(r.result)},r.readAsDataURL(s),v(!0);try{console.log("[Onboarding] Uploading avatar...");let e=await f.x.profile.uploadAvatar(s);console.log("[Onboarding] Upload result:",e),U("avatarUrl",e.url),t({title:"Photo uploaded",description:"Your profile photo has been updated"})}catch(e){console.error("[Onboarding] Upload error:",e),t({title:"Upload failed",description:e instanceof Error?e.message:"Failed to upload image. Please try again.",variant:"destructive"})}finally{v(!1)}},O=async s=>{try{let r=`${s.dobYear}-${s.dobMonth.padStart(2,"0")}-${s.dobDay.padStart(2,"0")}`,a={name:s.name,gender:s.gender,dob:r,bio:s.bio,avatarUrl:s.avatarUrl};console.log("[Onboarding] Submitting profile:",a);let o=await f.x.profile.create(a);console.log("[Onboarding] Profile created:",o),t({title:"Welcome to PharmX Social!",description:"Your profile has been created successfully. Let's find you a voice chat!"}),console.log("[Onboarding] Profile creation successful - redirecting to voice page"),e.push("/app/voice")}catch(s){console.error("[Onboarding] Profile creation error:",s);let e="Failed to create profile. Please try again.";s instanceof Error&&(e=s.message,s.details&&(e=`${s.message} - ${s.details}`)),t({title:"Failed to create profile",description:e,variant:"destructive"}),console.error("[Onboarding] Full error details:",{message:s instanceof Error?s.message:"Unknown error",details:s instanceof Error&&"details"in s?s.details:void 0,error:s})}};return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-start justify-center p-4 pt-8 sm:pt-16",children:r.jsx("div",{className:"w-full max-w-2xl lg:max-w-4xl",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-6 sm:p-8 lg:p-12",children:[(0,r.jsxs)("div",{className:"text-center mb-8 lg:mb-12",children:[r.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:"Complete Your Profile"}),r.jsx("p",{className:"text-gray-500 mt-2 text-lg",children:"All fields are required"})]}),(0,r.jsxs)("form",{onSubmit:$(O),className:"space-y-6 lg:space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[r.jsx("div",{className:"relative w-32 h-32 sm:w-40 sm:h-40 lg:w-48 lg:h-48 rounded-lg overflow-hidden border-4 border-gray-200",children:s?r.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${s})`}}):r.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:r.jsx(p.Z,{className:"w-8 h-8 sm:w-12 sm:h-12 lg:w-16 lg:h-16 text-gray-400"})})}),(0,r.jsxs)("div",{children:[r.jsx(c.I,{id:"avatar",type:"file",accept:"image/*",className:"hidden",onChange:F,disabled:y}),r.jsx(u._,{htmlFor:"avatar",className:"cursor-pointer inline-block",children:r.jsx("div",{className:"bg-white hover:bg-gray-100 text-black border border-gray-300 px-4 py-2 rounded-md text-sm font-medium transition-colors",children:y?"Uploading...":"Upload Photo"})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"name",className:"text-gray-700 font-medium",children:"Name"}),r.jsx(c.I,{id:"name",placeholder:"Your display name",className:"w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500",...q("name")}),A.name&&r.jsx("p",{className:"text-sm text-red-500",children:A.name.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{className:"text-gray-700 font-medium",children:"Gender"}),(0,r.jsxs)(m.E,{onValueChange:e=>U("gender",e),className:"flex gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(m.m,{value:"male",id:"male",className:"text-black border-gray-400"}),r.jsx(u._,{htmlFor:"male",className:"text-gray-700 cursor-pointer",children:"Male"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(m.m,{value:"female",id:"female",className:"text-black border-gray-400"}),r.jsx(u._,{htmlFor:"female",className:"text-gray-700 cursor-pointer",children:"Female"})]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx(x.Z,{className:"w-3 h-3"})," Cannot be changed later"]}),A.gender&&r.jsx("p",{className:"text-sm text-red-500",children:A.gender.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{className:"text-gray-700 font-medium",children:"Date of Birth"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("div",{className:"flex-1",children:r.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"DD",maxLength:2,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...q("dobDay"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");if(N(t),U("dobDay",t),2===t.length){let e=document.querySelector('input[name="dobMonth"]');e?.focus()}},value:w})}),r.jsx("div",{className:"flex-1",children:r.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"MM",maxLength:2,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...q("dobMonth"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");if(P(t),U("dobMonth",t),2===t.length){let e=document.querySelector('input[name="dobYear"]');e?.focus()}},value:j})}),r.jsx("div",{className:"flex-[1.5]",children:r.jsx(c.I,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"YYYY",maxLength:4,className:"w-full text-center border-gray-300 focus:border-blue-500 focus:ring-blue-500",...q("dobYear"),onChange:e=>{let t=e.target.value.replace(/\D/g,"");S(t),U("dobYear",t)},value:k})})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"You must be 18 or older"}),(A.dobDay||A.dobMonth||A.dobYear)&&r.jsx("p",{className:"text-sm text-red-500",children:A.dobDay?.message||A.dobMonth?.message||A.dobYear?.message})]})]}),r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"bio",className:"text-gray-700 font-medium",children:"Bio"}),r.jsx(h.g,{id:"bio",placeholder:"Tell us about yourself...",className:"resize-none h-32 lg:h-40 w-full border-gray-300 focus:border-blue-500 focus:ring-blue-500",maxLength:160,...q("bio")}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 text-right",children:[T.bio?.length||0,"/160 characters"]}),A.bio&&r.jsx("p",{className:"text-sm text-red-500",children:A.bio.message})]})})]}),r.jsx("div",{className:"pt-4",children:r.jsx(d.z,{type:"submit",className:"w-full lg:w-auto lg:px-12 bg-black hover:bg-gray-900 text-white font-semibold py-3 rounded-lg transition-colors",disabled:C,children:C?"Creating Profile...":"Complete Profile"})})]})]})})})}},7241:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var r=s(9899),a=s(5507),o=s(4036),i=s(1138),n=s(6409);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...i},d)=>{let c=a?o.g7:"button";return r.jsx(c,{className:(0,n.cn)(l({variant:t,size:s,className:e})),ref:d,...i})});d.displayName="Button"},6711:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});var r=s(9899),a=s(5507),o=s(6409);let i=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));i.displayName="Input"},8455:(e,t,s)=>{"use strict";s.d(t,{_:()=>d});var r=s(9899),a=s(5507),o=s(883),i=s(1138),n=s(6409);let l=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...t},s)=>r.jsx(o.f,{ref:s,className:(0,n.cn)(l(),e),...t}));d.displayName=o.f.displayName},573:(e,t,s)=>{"use strict";s.d(t,{E:()=>l,m:()=>d});var r=s(9899),a=s(5507),o=s(2258),i=s(8443),n=s(6409);let l=a.forwardRef(({className:e,...t},s)=>r.jsx(o.fC,{className:(0,n.cn)("grid gap-2",e),...t,ref:s}));l.displayName=o.fC.displayName;let d=a.forwardRef(({className:e,...t},s)=>r.jsx(o.ck,{ref:s,className:(0,n.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:r.jsx(o.z$,{className:"flex items-center justify-center",children:r.jsx(i.Z,{className:"h-3.5 w-3.5 fill-primary"})})}));d.displayName=o.ck.displayName},3184:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});var r=s(9899),a=s(5507),o=s(6409);let i=a.forwardRef(({className:e,...t},s)=>r.jsx("textarea",{className:(0,o.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));i.displayName="Textarea"},3134:(e,t,s)=>{"use strict";s.d(t,{x:()=>o});let r=process.env.NEXT_PUBLIC_API_URL||"https://pharmx-api.kasimhussain333.workers.dev";class a{constructor(){this.token=null,this.sessionId=null,this.auth={logout:async()=>{await this.request("/auth/logout",{method:"POST"}),this.clearAuth()},verify:()=>this.request("/auth/verify")},this.profile={get:()=>this.request("/profile"),update:e=>this.request("/profile",{method:"PUT",body:JSON.stringify(e)}),uploadAvatar:async e=>{let t=new FormData;return t.append("file",e),this.request("/upload/avatar",{method:"POST",body:t})},create:e=>this.request("/profile",{method:"POST",body:JSON.stringify(e)}),delete:()=>this.request("/profile",{method:"DELETE"})},this.users={list:e=>{let t=new URLSearchParams(e).toString();return this.request(`/users${t?`?${t}`:""}`)},get:e=>this.request(`/users/${e}`),search:e=>this.request(`/users/search?q=${encodeURIComponent(e)}`)},this.chats={list:()=>this.request("/chats"),create:e=>this.request("/chats",{method:"POST",body:JSON.stringify({otherUserId:e})}),getMessages:(e,t)=>{let s=new URLSearchParams(t).toString();return this.request(`/chats/${e}/messages${s?`?${s}`:""}`)},sendMessage:(e,t)=>this.request(`/chats/${e}/messages`,{method:"POST",body:JSON.stringify({content:t})})},this.health=()=>fetch(`${r}/health`).then(e=>e.json())}setAuth(e,t){console.log("[API Client] Setting auth - Token length:",e.length,"Session ID:",t),this.token=e,this.sessionId=t}setToken(e){console.log("[API Client] Setting token only - Length:",e.length),this.token=e}getToken(){return this.token,this.token}getSessionId(){return this.sessionId,this.sessionId}clearAuth(){this.token=null,this.sessionId=null}clearToken(){this.clearAuth()}async request(e,t={}){let s={...t.headers||{}};s["Content-Type"]||t.body instanceof FormData||(s["Content-Type"]="application/json"),this.token&&(s.Authorization=`Bearer ${this.token}`),this.sessionId&&(s["X-Session-ID"]=this.sessionId);let a=`${r}${e}`;console.log(`[API] ${t.method||"GET"} ${a}`),console.log("[API] Headers:",s),t.body instanceof FormData&&console.log("[API] Sending FormData with keys:",Array.from(t.body.keys()));try{let r=await fetch(a,{...t,headers:s,credentials:"include",mode:"cors"});if(!r.ok){let t=`Request failed with status ${r.status}`,s=null;try{let a=await r.json();t=a.error||a.message||t,s=a.details,console.error(`[API Error] ${e}:`,a)}catch{t=r.statusText||t}401===r.status&&(console.log("[API] 401 Unauthorized - clearing auth and redirecting to login"),this.clearAuth(),window.location.href="/login");let a=Error(t);throw s&&(a.details=s),a}let o=await r.json();return console.log(`[API Response] ${e}:`,o),o}catch(e){if(e instanceof TypeError&&"Failed to fetch"===e.message)throw console.error("[API] Network error - Failed to fetch. Possible causes:"),console.error("  1. CORS blocking the request"),console.error("  2. Network connectivity issues"),console.error("  3. API server is down"),console.error("  4. SSL/TLS certificate issues"),console.error(`  URL: ${a}`),Error("Network error: Unable to connect to the server. Please check your connection and try again.");throw e}}}let o=new a},6904:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2772).createProxy)(String.raw`C:\Users\kasim\pharmx-social-1\frontend\app\onboarding\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[916,573,645,801,101],()=>s(9264));module.exports=r})();