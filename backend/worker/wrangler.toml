name = "pharmx-api-worker"
main = "src/index.ts"
compatibility_date = "2024-08-21"
compatibility_flags = ["nodejs_compat"]

[site]
bucket = "./public"

# Add the route to your custom domain
routes = [
  { pattern = "chat.pharmx.co.uk/*", zone_name = "pharmx.co.uk" }
]

# Durable Object bindings
[[durable_objects.bindings]]
name = "CHAT_ROOMS"
class_name = "ChatRoom"

[[durable_objects.bindings]]
name = "MATCHMAKING_QUEUE"  
class_name = "MatchmakingQueue"

[[durable_objects.bindings]]
name = "LOBBY"
class_name = "LobbyDO"

# Durable Object migrations (required for free plan)
[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom", "MatchmakingQueue", "LobbyDO"]

# Cron triggers
[triggers]
crons = ["0 2 * * *"]
