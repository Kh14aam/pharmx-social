(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[796],{5519:function(e,t,s){Promise.resolve().then(s.bind(s,8488))},8488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(7437),a=s(9376),o=s(2265),n=s(6070),i=s(2869),l=s(5186),c=s(6831),d=s(3247),u=s(740),h=s(3417),m=s(8906),f=s(8617),g=s(5153),p=s(7855);function x(){let e=(0,a.useRouter)(),{toast:t}=(0,g.pm)(),[s,x]=(0,o.useState)([]),[v,b]=(0,o.useState)(!0),[y,w]=(0,o.useState)(""),[N,S]=(0,o.useState)([]);(0,o.useEffect)(()=>{j()},[]),(0,o.useEffect)(()=>{y.trim()?S(s.filter(e=>{var t,s;return e.name.toLowerCase().includes(y.toLowerCase())||(null===(t=e.bio)||void 0===t?void 0:t.toLowerCase().includes(y.toLowerCase()))||(null===(s=e.location)||void 0===s?void 0:s.toLowerCase().includes(y.toLowerCase()))})):S(s)},[y,s]);let j=async()=>{try{b(!0);let e=await p.x.users.list({limit:50});x(e.users||[]),S(e.users||[])}catch(e){console.error("Error fetching users:",e),t({title:"Error loading users",description:"Failed to load user profiles",variant:"destructive"})}finally{b(!1)}},k=async(s,r)=>{r.stopPropagation();try{let r=await p.x.request("/users/".concat(s.id,"/can-message"),{method:"POST"});if(!r.canMessage&&r.membershipRequired){let e=prompt("Send a message to ".concat(s.name," (Membership required for messaging):"),"Hi! I'd like to chat with you.");e&&e.trim()&&t({title:"Membership Required",description:"Upgrade to premium to send messages to other users",variant:"destructive"});return}let a=prompt("Send a message to ".concat(s.name,":"),"Hi! I'd like to chat with you.");if(a&&a.trim())try{await p.x.request("/chats/request",{method:"POST",body:JSON.stringify({receiverId:s.id,message:a.trim()})}),t({title:"Message sent!",description:"Your message to ".concat(s.name," has been sent")}),e.push("/app/chats?tab=requests")}catch(r){console.error("Error sending chat request:",r);let s="Please try again later";if(r instanceof Error){if(r.message.includes("already exists")){s="You already have a chat with this person",e.push("/app/chats");return}s=r.message.includes("already sent")?"You've already sent a message to this person":r.message}t({title:"Failed to send message",description:s,variant:"destructive"})}}catch(e){console.error("Error checking message permissions:",e),t({title:"Error",description:"Failed to process your request",variant:"destructive"})}},I=e=>{try{let t=new Date(e),s=new Date,r=s.getFullYear()-t.getFullYear(),a=s.getMonth()-t.getMonth();return(a<0||0===a&&s.getDate()<t.getDate())&&r--,r>0?r:null}catch(e){return null}};return v?(0,r.jsx)("div",{className:"container max-w-6xl mx-auto px-2 sm:px-4 py-4",children:(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:[...Array(8)].map((e,t)=>(0,r.jsx)(n.Zb,{className:"overflow-hidden animate-pulse",children:(0,r.jsx)("div",{className:"aspect-[3/4] bg-gray-200 dark:bg-gray-800"})},t))})}):(0,r.jsxs)("div",{className:"container max-w-6xl mx-auto px-2 sm:px-4 py-4",children:[(0,r.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(l.I,{placeholder:"Search users by name, bio, or location...",value:y,onChange:e=>w(e.target.value),className:"pl-10 pr-10"}),(0,r.jsx)(i.z,{size:"icon",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7",children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})})]}),y&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Found ",N.length," user",1!==N.length?"s":"",' matching "',y,'"']})]}),N.length>0?(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:N.map(e=>{var t,s;let a=e.created_at?I(e.created_at):null;return(0,r.jsx)(n.Zb,{className:"overflow-hidden group hover:shadow-xl transition-all duration-300 border-0",children:(0,r.jsxs)("div",{className:"relative aspect-[3/4]",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:e.avatar_url?"url(".concat(e.avatar_url.startsWith("http")?e.avatar_url:"https://pharmx-api.kasimhussain333.workers.dev".concat(e.avatar_url),")"):"none",backgroundColor:e.avatar_url?"transparent":"#f3f4f6"},children:!e.avatar_url&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(c.qE,{className:"h-16 w-16",children:(0,r.jsx)(c.Q5,{className:"text-2xl bg-gradient-to-br from-blue-500 to-purple-600 text-white",children:(null===(s=e.name)||void 0===s?void 0:null===(t=s.charAt(0))||void 0===t?void 0:t.toUpperCase())||"?"})})})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-black/80"}),(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 flex items-center justify-between text-white",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",children:e.name}),a&&(0,r.jsx)("span",{className:"text-lg opacity-90",children:a})]}),(0,r.jsx)(i.z,{size:"sm",className:"h-8 w-8 bg-white/20 backdrop-blur-sm hover:bg-white/30 border-0 text-white",onClick:t=>k(e,t),children:(0,r.jsx)(h.Z,{className:"h-3.5 w-3.5"})})]}),e.verified&&(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)(m.Z,{className:"h-5 w-5 text-blue-400"})})]})},e.id)})}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:(0,r.jsx)(d.Z,{className:"h-8 w-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No users found"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:y?'No users match "'.concat(y,'"'):"No users available at the moment"}),y&&(0,r.jsx)(i.z,{variant:"outline",onClick:()=>w(""),className:"mt-4",children:"Clear search"})]}),(0,r.jsx)("div",{className:"mt-8 text-center",children:(0,r.jsxs)(n.Zb,{className:"p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 border-blue-200 dark:border-blue-800",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[(0,r.jsx)(f.Z,{className:"h-5 w-5 text-yellow-600"}),(0,r.jsx)("span",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Premium Feature"})]}),(0,r.jsx)("p",{className:"text-blue-700 dark:text-blue-300 text-sm",children:"Upgrade to premium to send messages to other users and unlock unlimited connections"})]})})]})}},6831:function(e,t,s){"use strict";s.d(t,{F$:function(){return l},Q5:function(){return c},qE:function(){return i}});var r=s(7437),a=s(2265),o=s(1146),n=s(4508);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.fC,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...a})});i.displayName=o.fC.displayName;let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.Ee,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",s),...a})});l.displayName=o.Ee.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.NY,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...a})});c.displayName=o.NY.displayName},2869:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var r=s(7437),a=s(2265),o=s(7053),n=s(535),i=s(4508);let l=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:a,size:n,className:s})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,s){"use strict";s.d(t,{Zb:function(){return n}});var r=s(7437),a=s(2265),o=s(4508);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...a})});n.displayName="Card",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",s),...a})}).displayName="CardHeader",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",s),...a})}).displayName="CardTitle",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...a})}).displayName="CardDescription",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",s),...a})}).displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},5186:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var r=s(7437),a=s(2265),o=s(4508);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},5153:function(e,t,s){"use strict";s.d(t,{pm:function(){return h}});var r=s(2265);let a=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=i(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function h(){let[e,t]=r.useState(c);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},7855:function(e,t,s){"use strict";s.d(t,{x:function(){return o}});let r="https://pharmx-api.kasimhussain333.workers.dev";class a{setAuth(e,t){console.log("[API Client] Setting auth - Token length:",e.length,"Session ID:",t),this.token=e,this.sessionId=t,localStorage.setItem("pharmx_token",e),localStorage.setItem("pharmx_session",t),console.log("[API Client] Stored auth in localStorage")}setToken(e){console.log("[API Client] Setting token only - Length:",e.length),this.token=e,localStorage.setItem("pharmx_token",e),console.log("[API Client] Stored token in localStorage")}getToken(){return this.token||(this.token=localStorage.getItem("pharmx_token")),this.token}getSessionId(){return this.sessionId||(this.sessionId=localStorage.getItem("pharmx_session")),this.sessionId}clearAuth(){this.token=null,this.sessionId=null,localStorage.removeItem("pharmx_token"),localStorage.removeItem("pharmx_session")}clearToken(){this.clearAuth()}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={...t.headers||{}};s["Content-Type"]||t.body instanceof FormData||(s["Content-Type"]="application/json"),this.token&&(s.Authorization="Bearer ".concat(this.token)),this.sessionId&&(s["X-Session-ID"]=this.sessionId);let a="".concat(r).concat(e);console.log("[API] ".concat(t.method||"GET"," ").concat(a)),console.log("[API] Headers:",s),t.body instanceof FormData&&console.log("[API] Sending FormData with keys:",Array.from(t.body.keys()));try{let r=await fetch(a,{...t,headers:s,credentials:"include",mode:"cors"});if(!r.ok){let t="Request failed with status ".concat(r.status),s=null;try{let a=await r.json();t=a.error||a.message||t,s=a.details,console.error("[API Error] ".concat(e,":"),a)}catch(e){t=r.statusText||t}401===r.status&&(console.log("[API] 401 Unauthorized - clearing auth and redirecting to login"),this.clearAuth(),window.location.href="/login");let a=Error(t);throw s&&(a.details=s),a}let o=await r.json();return console.log("[API Response] ".concat(e,":"),o),o}catch(e){if(e instanceof TypeError&&"Failed to fetch"===e.message)throw console.error("[API] Network error - Failed to fetch. Possible causes:"),console.error("  1. CORS blocking the request"),console.error("  2. Network connectivity issues"),console.error("  3. API server is down"),console.error("  4. SSL/TLS certificate issues"),console.error("  URL: ".concat(a)),Error("Network error: Unable to connect to the server. Please check your connection and try again.");throw e}}constructor(){this.token=null,this.sessionId=null,this.auth={logout:async()=>{await this.request("/auth/logout",{method:"POST"}),this.clearAuth()},verify:()=>this.request("/auth/verify")},this.profile={get:()=>this.request("/profile"),update:e=>this.request("/profile",{method:"PUT",body:JSON.stringify(e)}),uploadAvatar:async e=>{let t=new FormData;return t.append("file",e),this.request("/upload/avatar",{method:"POST",body:t})},create:e=>this.request("/profile",{method:"POST",body:JSON.stringify(e)}),delete:()=>this.request("/profile",{method:"DELETE"})},this.users={list:e=>{let t=new URLSearchParams(e).toString();return this.request("/users".concat(t?"?".concat(t):""))},get:e=>this.request("/users/".concat(e)),search:e=>this.request("/users/search?q=".concat(encodeURIComponent(e)))},this.chats={list:()=>this.request("/chats"),create:e=>this.request("/chats",{method:"POST",body:JSON.stringify({otherUserId:e})}),getMessages:(e,t)=>{let s=new URLSearchParams(t).toString();return this.request("/chats/".concat(e,"/messages").concat(s?"?".concat(s):""))},sendMessage:(e,t)=>this.request("/chats/".concat(e,"/messages"),{method:"POST",body:JSON.stringify({content:t})})},this.health=()=>fetch("".concat(r,"/health")).then(e=>e.json()),this.token=localStorage.getItem("pharmx_token"),this.sessionId=localStorage.getItem("pharmx_session")}}let o=new a},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return o}});var r=s(1994),a=s(3335);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}}},function(e){e.O(0,[317,737,971,117,744],function(){return e(e.s=5519)}),_N_E=e.O()}]);